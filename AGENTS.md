# Repository Guidelines

## Project Structure & Module Organization

- `src/`: TypeScript source for the `polycodex` CLI.
  - Core modules: auth swapping (`src/authSwap.ts`), config (`src/config.ts`), account metadata (`src/accountMeta.ts`), CLI entry (`src/cli.ts`).
- `test/`: Unit tests (`bun:test`).
- `docs/`: User documentation (e.g. `docs/how-it-works.md`, `docs/releasing.md`).
- `dist/`: Build output (`dist/cli.js`, generated by `bun run build`).
- `scripts/`: Small build helpers (e.g. `scripts/postbuild.ts`).

## Build, Test, and Development Commands

- `bun install`: install dependencies.
- `bun run dev`: run the CLI from source (useful during development).
- `bun test`: run unit tests.
- `bun run typecheck`: run TypeScript typechecking (`tsc --noEmit`).
- `bun run build`: build a Node-targeted CLI to `dist/cli.js` (adds shebang + executable bit).
- `npm pack`: preview the npm tarball contents before publishing.

## Coding Style & Naming Conventions

- Language: TypeScript (ESM).
- Prefer small, focused modules in `src/` with explicit exports.
- Naming:
  - files: `camelCase.ts` for modules (e.g. `accountMeta.ts`)
  - functions: `camelCase`
  - types: `PascalCase`
- Keep CLI output and error messages actionable and user-facing.

## Testing Guidelines

- Framework: `bun:test`.
- Add tests for new behaviors and edge cases (flags, argument parsing, file I/O).
- Test files live under `test/` and use `*.test.ts` naming.

## Commit & Pull Request Guidelines

- Commit messages follow Conventional Commits (examples in history: `feat:`, `fix:`, `docs:`, `chore:`, `refactor:`).
- PRs should include:
  - a short description of the behavior change
  - updated docs if CLI UX changes (`README.md`, `docs/`)
  - tests for non-trivial logic changes

## Agent-Specific Instructions

- Do not create git commits (or rewrite history) unless explicitly asked.

## Security & Configuration Tips

- `polycodex` swaps `~/.codex/auth.json` under a lock; avoid manual edits while it is running.
- Local state is stored under `~/.config/polycodex` (override with `POLYCODEX_HOME` for testing).
